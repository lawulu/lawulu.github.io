<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>个人博客</title>
    <link>https://lawulu.github.io/tags/sign/index.xml</link>
    <description>Recent content on 个人博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <atom:link href="https://lawulu.github.io/tags/sign/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>一种统一的API签名校验实现</title>
      <link>https://lawulu.github.io/tech/%E4%B8%80%E7%A7%8D%E7%BB%9F%E4%B8%80%E7%9A%84API%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%E6%96%B9%E6%B3%95/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://lawulu.github.io/tech/%E4%B8%80%E7%A7%8D%E7%BB%9F%E4%B8%80%E7%9A%84API%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%E6%96%B9%E6%B3%95/</guid>
      <description>&lt;p&gt;##签名方法:
####Header:
@RequestHeader(value = &amp;ldquo;x-header-timestamp&amp;rdquo;) Long timestamp,
@RequestHeader(value = &amp;ldquo;x-header-appid&amp;rdquo;) String appid,
@RequestHeader(value = &amp;ldquo;x-header-sign&amp;rdquo;) String sign
####源串 orignalString:
HttpMethod=URI&amp;amp;Param1=Value1&amp;amp;Param2=Value2RequestBodySeckeyTimestamp
注1:Method大写
注2:为方便期间Param不排序,如果出问题再说
注3:ResustBody可能为空
注4:SecKey跟AppId是一一对应.
####签名 sign:
sign=Md5(orignalString).toUpperCase
暂时只支持MD5
##实现:
原则上,应该和业务逻辑代码分离,不影响业务逻辑代码的开发
####1 根据注解Mapping需要检查签名的方法
例如:Spring @ControllerAdvice(annotations = RestController.class)
如需要,可自定义自己的注解
####2 获取参数
@ModelAttribute
    public void checkSign(HttpServletRequest request, HttpServletResponse response, @RequestBody(required=false) String requestbody,
            @RequestHeader(value = &amp;ldquo;x-header-timestamp&amp;rdquo;) Long timestamp,
            @RequestHeader(value = &amp;ldquo;x-header-appid&amp;rdquo;) String appid,
            @RequestHeader(value = &amp;ldquo;x-header-sign&amp;rdquo;) String sign)
####3 计算签名
可能需要在GLobalExceptionHandler中增加&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;@ExceptionHandler(ServletRequestBindingException.class) 
    @ResponseStatus(HttpStatus.BAD_REQUEST) 
    @ResponseBody 
    ErrorMessage handleServletRequestBindingException(ServletRequestBindingException ex) {  

        LOGGER.debug(&amp;quot;handleServletRequestBindingException&amp;quot;, ex);
        return new ErrorMessage(ErrorCode.INVALID_HEADER.getCode(), ex.getMessage());//TODO
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;##需要在Filter中Copy一份Request出来:&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>